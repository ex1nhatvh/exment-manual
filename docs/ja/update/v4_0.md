# 更新手順 v4.0.0
version4.0.0では、使用フレームワークのバージョン変更につき、特別なアップデート手順が必要になります。  
ここでは、アップデート手順を記載します。

## リリース背景
Exment4.Xでは、内部フレームワークのバージョンアップを行っています。  
これは、フレームワークLaravel5.6のサポート・セキュリティフィックスの終了に伴うものです。  

- Exment3.X以下 : Laravel5.6
- Exment4.X以上 : Laravel6.20以上

2021/01/20、[Laravel5.6を含めたLaravelの脆弱性の報告](https://github.com/advisories/GHSA-3p32-j457-pg5x)が行われていることから、早急にアップデートをお願いします。


## 事前準備
- composerのバージョンが2であることを確認してください。  
確認手順は、[こちら](/ja/update_composer)をご確認ください。

- Exmentのバックアップを行ってください。  
バックアップ実施方法は、[こちら](/ja/backup)をご確認ください。


## アップデート手順

### コマンド実行1

- 以下のコマンドを実行します。

```
# 関連ライブラリのバージョンを指定する
composer require lcobucci/jwt=3.3.*
```


### composer.json修正
- フォルダ直下の、composer.jsonを開きます。

- "require"内の、以下の記載を変更します。

```
#### laravel/framework修正
- 修正前
        "laravel/framework": "5.6.*",
- 修正後
        "laravel/framework": "6.*",

#### exceedone/exment、exceedone/laravel-adminの修正
#### composer.json内に、exceedone/exmentとexceedone/laravel-adminの記載があれば、修正をお願いします。ない場合は、修正は不要です。
- 修正後
        "exceedone/exment": "*",
        "exceedone/laravel-admin": "*",
```

### コマンド実行2

- 以下のコマンドを実行します。

```
# Laravelフレームワーク、Exment、関連ライブラリのアップデート実施
composer update

# Exmentアップデート内容反映
php artisan exment:update
```

## アップデート完了
これで、アップデートが完了します。  
※万が一、何らかの理由でアップデートに失敗した場合、[こちら](https://github.com/exceedone/exment/issues/885)にご報告ください。

